{% extends 'base.html' %}

{% block content %}

<div class="row valign-wrapper">
    <div class="col s12 m8">
        <h1>Viewing Parties</h1>
    </div>
    <div class="col s12 m4 right-align">
        <a class="dropdown-trigger btn" href="#" data-target="filter-dropdown"><span class="material-icons" style="vertical-align:middle; margin-right: 5px;">sort</span>Sort</a>
        <ul id="filter-dropdown" class="dropdown-content">
            <li><a href="?orderby=start_date">By Date</a></li>
            <li><a href="?orderby=attendees">By # of Attendees</a></li>
        </ul>
    </div>
</div>


<div class="row">
    {% for party in viewingparty_list %}

    <div class="col s12 m6 l4">
        <a href="{% url 'parties_detail' party.id %}">
            <div class="card z-depth-2">
                <div class="card-image">
                    <img src="" height="200px" style="background-color: black;">
                    <span class="card-title">{{ party.name }}</span>
                    {% if user in party.attendees.all %}
                        <a href="{% url 'parties_remove_attendee' party.id %}" class="btn-floating halfway-fab waves-effect waves-light red"><i class="material-icons">person_remove</i></a>
                    {% else %}
                        <a href="{% url 'parties_add_attendee' party.id %}" class="btn-floating pulse halfway-fab waves-effect waves-light blue"><i class="material-icons">person_add</i></a>
                    {% endif %}
                </div>
                <div class="card-content">
                    <p><i class="tiny material-icons">place</i> {{ party.party_location }}</p>
                    <p><i class="tiny material-icons">event</i> {{ party.start_date }} @ {{ party.start_time }}</p>
                    <p><i class="tiny material-icons">group</i> {{ party.attendees.all|length}} Attending</p>
                </div>
            </div>
        </a>
    </div>

    {% endfor %}
</div>

<script>
    const filterEl = document.querySelector('.dropdown-trigger');
    M.Dropdown.init(filterEl, {
        alignment: 'right',
        coverTrigger: false,
        constrainWidth: false
    });
</script>

{% endblock %}